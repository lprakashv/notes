

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Java Multi-threading &#8212; Lalit&#39;s Tech Notebook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'java/java-multithreading';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Java Snippets" href="java-snippets.html" />
    <link rel="prev" title="Java - Misc" href="java-misc.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../BOOK.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Lalit's Tech Notebook - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Lalit's Tech Notebook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../BOOK.html">
                    Lalit’s Tech Notes
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Java</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="java-gc.html">Java Garbage Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="java-misc.html">Java - Misc</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Java Multi-threading</a></li>
<li class="toctree-l1"><a class="reference internal" href="java-snippets.html">Java Snippets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spring</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../spring/spring-data-transactions.html">Data Transactions with Spring</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spring/spring-cloud-0.html">Spring Cloud Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-1-distributed-config.html">Distributed Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-2-service-discovery.html">Service Discovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-3-intelligent-routing.html">Intelligent Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-4-cslb.html">CSLB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-5-self-healing-services.html">Self Healing Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spring/spring-cloud-6-wrap.html">Wrap - Big Picture</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Apache Spark</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../apache-spark/apache-spark.html">Apache Spark</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gradle</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../gradle/gradle.html">Gradle</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Golang</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../go/basic-syntax.html">Basic Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/code-generation.html">Code Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/concurrency.html">Concurrency in Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/database.html">Database Programming in Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/grpc-app.html">gRPC in Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/http-services.html">HTTP in Go</a></li>
<li class="toctree-l1"><a class="reference internal" href="../go/testing.html">Testing in Go</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Rust</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../rust/rust-snippets.html">Rust Snippets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../concepts/concurrency.html">Concurrency</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Kubernetes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/kubernetes-intro.html">Kubernetes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes/namespaces.html">Kubernetes Namespaces</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Commands and CheatSheets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../command-cheatsheets/docker-cheatsheet.html">Docker cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command-cheatsheets/kubectl-cheatsheet.html">Kubectl Cheat Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command-cheatsheets/misc-commands.html">Miscellaneous Helpful Commands</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Generative AI</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../generative-ai/building-systems-with-chatgpt.html">Building Systems with ChatGPT AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generative-ai/prompt-engineering.html">ChatGPT Prompt Engineering</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MLOps</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mlops/ml-in-production.html">ML in Production</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Work Learnings Journal</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../journal.html">Work Learnings Journal (Appended to each topic section)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lprakashv/notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lprakashv/notes/issues/new?title=Issue%20on%20page%20%2Fjava/java-multithreading.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/java/java-multithreading.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Java Multi-threading</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#java-thread-class-methods">Java <code class="docutils literal notranslate"><span class="pre">Thread</span></code> class methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-currentthread"><code class="docutils literal notranslate"><span class="pre">Thread.currentThread()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-getid"><code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">getId()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#int-getpriority-and-void-setpriority"><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">getPriority()</span></code> and <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setPriority()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-state-getstate"><code class="docutils literal notranslate"><span class="pre">Thread.State</span> <span class="pre">getState()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-interrupt"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">interrupt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-join"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">join()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-run"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-setdaemon-boolean-on"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setDaemon(boolean</span> <span class="pre">on)</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-sleep-long-millis"><code class="docutils literal notranslate"><span class="pre">Thread.sleep(long</span> <span class="pre">millis)</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-start"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">start()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-yield"><code class="docutils literal notranslate"><span class="pre">Thread.yield()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-lifecycle">Thread Lifecycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-thread-enter-the-non-runnable-state">How does a thread enter the non-runnable state</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-safey">Thread Safey</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-area">Critical Area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#race-conditions">Race Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-resources-are-thread-safe">Which resources are Thread-Safe</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multithreading-in-practice">Multithreading in Practice</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-computation-into-a-separate-thread-spawning-threads">Running computation into a separate thread - spawning threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-thread-synchronization">Basic Thread synchronization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-pools">Thread Pools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#countdownlatch">CountDownLatch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrent-thread-safe-data-structures">Concurrent (thread-safe) Data structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blockingqueue">BlockingQueue</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wait-notify">Wait-Notify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wait">Wait</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notify">Notify</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notify-all">Notify-All</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#re-entrant-lock">Re-Entrant Lock</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deadlock">Deadlock</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#semaphores">Semaphores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#callable-and-future">Callable and Future</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupts">Interrupts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="java-multi-threading">
<h1>Java Multi-threading<a class="headerlink" href="#java-multi-threading" title="Permalink to this heading">#</a></h1>
<section id="java-thread-class-methods">
<h2>Java <code class="docutils literal notranslate"><span class="pre">Thread</span></code> class methods<a class="headerlink" href="#java-thread-class-methods" title="Permalink to this heading">#</a></h2>
<section id="thread-currentthread">
<h3><code class="docutils literal notranslate"><span class="pre">Thread.currentThread()</span></code><a class="headerlink" href="#thread-currentthread" title="Permalink to this heading">#</a></h3>
<p>The return type of this method is Thread, it returns a reference of currently executing thread (who touched this method). It does not raise any exception.</p>
</section>
<section id="long-getid">
<h3><code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">getId()</span></code><a class="headerlink" href="#long-getid" title="Permalink to this heading">#</a></h3>
<p>The thread ID is a positive long number generated when this thread was created.</p>
<p>The thread ID is unique and remains unchanged during its lifetime. When a thread is terminated, this thread ID may be reused.</p>
</section>
<section id="int-getpriority-and-void-setpriority">
<h3><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">getPriority()</span></code> and <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setPriority()</span></code><a class="headerlink" href="#int-getpriority-and-void-setpriority" title="Permalink to this heading">#</a></h3>
<p>The priority of thread can either be assigned by the JVM or by the programmer explicitly while creating the thread.</p>
<p>The thread’s priority is in the range of 1 to 10. The <strong>default priority of a thread is 5</strong>.</p>
</section>
<section id="thread-state-getstate">
<h3><code class="docutils literal notranslate"><span class="pre">Thread.State</span> <span class="pre">getState()</span></code><a class="headerlink" href="#thread-state-getstate" title="Permalink to this heading">#</a></h3>
</section>
<section id="void-interrupt">
<h3><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">interrupt()</span></code><a class="headerlink" href="#void-interrupt" title="Permalink to this heading">#</a></h3>
<p>An interrupt is an indication to a thread that it should stop what it is doing and do something else. It’s up to the programmer to decide exactly how a thread responds to an interrupt, but <strong>it is very common for the thread to terminate</strong>.</p>
</section>
<section id="void-join">
<h3><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">join()</span></code><a class="headerlink" href="#void-join" title="Permalink to this heading">#</a></h3>
<p>This java thread join method puts the current thread on wait until the thread on which it’s called is dead. If the thread is interrupted, it throws <code class="docutils literal notranslate"><span class="pre">InterruptedException</span></code>.</p>
<p>If the referenced thread was <strong>already terminated</strong> or <strong>hasn’t been started</strong>, the call to <code class="docutils literal notranslate"><span class="pre">join()</span></code> method returns <strong>immediately</strong>.</p>
</section>
<section id="void-run">
<h3><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">run()</span></code><a class="headerlink" href="#void-run" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">run()</span></code> method of a thread encapsulates the logic that should be run by a thread.</p>
</section>
<section id="void-setdaemon-boolean-on">
<h3><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setDaemon(boolean</span> <span class="pre">on)</span></code><a class="headerlink" href="#void-setdaemon-boolean-on" title="Permalink to this heading">#</a></h3>
<p>On the other hand, daemon threads are <strong>low-priority threads whose only role is to provide services to user threads</strong>. Since daemon threads are meant to serve user threads and are only needed while user threads are running, they won’t prevent the JVM from exiting once all user threads have finished their execution.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">setDaemon()</span></code> can only be called after the Thread object has been created and the thread has not been started. An <strong>attempt to call setDaemon() while a thread is running will throw an <code class="docutils literal notranslate"><span class="pre">IllegalThreadStateException</span></code></strong>.</p>
</section>
<section id="thread-sleep-long-millis">
<h3><code class="docutils literal notranslate"><span class="pre">Thread.sleep(long</span> <span class="pre">millis)</span></code><a class="headerlink" href="#thread-sleep-long-millis" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Thread.sleep()</span></code> the method can be used to pause the execution of the current thread for a specified time in milliseconds. The argument value for <strong>milliseconds can’t be negative</strong>, else it throws <code class="docutils literal notranslate"><span class="pre">IllegalArgumentException</span></code>.</p>
</section>
<section id="void-start">
<h3><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">start()</span></code><a class="headerlink" href="#void-start" title="Permalink to this heading">#</a></h3>
<p>When a program calls the <code class="docutils literal notranslate"><span class="pre">start()</span></code> method, a new thread is created, and then the <code class="docutils literal notranslate"><span class="pre">run()</span></code> method is executed.</p>
<p>We can’t call the <code class="docutils literal notranslate"><span class="pre">start()</span></code> method twice otherwise it will throw an <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code>.</p>
</section>
<section id="thread-yield">
<h3><code class="docutils literal notranslate"><span class="pre">Thread.yield()</span></code><a class="headerlink" href="#thread-yield" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">yield()</span></code> basically means that the thread is not doing anything particularly important and if any other threads or processes need to be run, they should run. Otherwise, the current thread will continue to run.</p>
<p>Use of yield method:</p>
<ul class="simple">
<li><p>Whenever a thread calls <code class="docutils literal notranslate"><span class="pre">java.lang.Thread.yield()</span></code> method, it gives hint to the thread scheduler that it is ready to pause its execution. The thread scheduler is free to ignore this hint.</p></li>
<li><p>If any thread executes yield method, <strong>thread scheduler checks if there is any thread with same or high priority than this thread</strong>. If the processor finds any thread with higher or same priority then it will move the current thread to Ready/Runnable state and give processor to other thread and if not — current thread will keep executing.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="thread-lifecycle">
<h2>Thread Lifecycle<a class="headerlink" href="#thread-lifecycle" title="Permalink to this heading">#</a></h2>
<p>According to Sun microsystems, there are 4 states in the java thread life cycle.</p>
<ul class="simple">
<li><p><strong>New</strong> — A thread is in the “New” state, when an object of the <strong>thread class is instantiated but the “start” method is not invoked</strong>.</p></li>
<li><p><strong>Runnable</strong> — When the <strong>“start” method has been invoked on the thread object</strong>. In this state, the thread is either waiting for the scheduler to pick it up for execution or it’s already running. Let us call the state <strong>when the thread is already picked for execution, the “running” state</strong>.</p></li>
<li><p><strong>Non-Runnable(Blocked , Timed-Waiting)</strong> — When the thread is alive, i.e., the thread class object exists, but it cannot be picked by the scheduler for execution. <strong>It is temporarily inactive</strong>.</p></li>
<li><p><strong>Terminated</strong> — When the thread completes execution of its “run” method. At this stage, the task of the thread is completed.</p></li>
</ul>
<p><img alt="Thread Lifecycle" src="../_images/threadlifecycle.png" /></p>
<section id="how-does-a-thread-enter-the-non-runnable-state">
<h3>How does a thread enter the non-runnable state<a class="headerlink" href="#how-does-a-thread-enter-the-non-runnable-state" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Forced reason</strong></p>
<ul>
<li><p>It is waiting for an I/O operation.</p></li>
<li><p>It is waiting on an object which is being held by another thread (Java associates “Monitor” to every object to enforce locking/synchronization).</p></li>
<li><p>Moved to sleep by scheduler based on the logic of resource sharing.</p></li>
</ul>
</li>
<li><p><strong>By choice</strong> - we can code inside “run” method or any method inside run which can deliberately give up CPU time.</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">sleep(long</span> <span class="pre">millis)</span></code></strong> thread gives up CPU time but keeps the lock.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">wait()</span></code></strong> or <strong><code class="docutils literal notranslate"><span class="pre">wait(long</span> <span class="pre">timeout)</span></code></strong> causes thread to give up CPU time as well as release any object lock. If used without timeout, it remains in non-runnable state endlessly unless we call <code class="docutils literal notranslate"><span class="pre">notfy()</span></code> or <code class="docutils literal notranslate"><span class="pre">notifyAll()</span></code> on  it.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">yield()</span></code></strong> - This method is like a notification to the scheduler, that the thread is ready to give up execution. The scheduler then decides, based on other live threads and their priorities, if it wants to move the calling thread to runnable and give the CPU time to other threads, or keep running the existing thread.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">join()</span></code></strong> is called to pause the execution of the program until the thread calling the join method is terminated.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="thread-safey">
<h2>Thread Safey<a class="headerlink" href="#thread-safey" title="Permalink to this heading">#</a></h2>
<p>A code that is safe to call by multiple threads simultaneously is called thread-safe.</p>
<section id="critical-area">
<h3>Critical Area<a class="headerlink" href="#critical-area" title="Permalink to this heading">#</a></h3>
<p>A critical area is a <strong>section of code that is executed by multiple threads and where the sequence of execution for the threads makes a difference in the result</strong> of the concurrent execution of the critical area.</p>
<p>The critical area could appear only when <strong>one or more threads write to the shared resources</strong>. It is safe to let multiple threads read the same resources, as long as the resources do not change.</p>
</section>
<section id="race-conditions">
<h3>Race Conditions<a class="headerlink" href="#race-conditions" title="Permalink to this heading">#</a></h3>
<p>A race condition is a special condition that may occur inside a critical area.</p>
<p>When the result of multiple threads executing a critical area may differ depending on the sequence in which the threads execute, the critical area is said to contain a race condition.</p>
</section>
<section id="which-resources-are-thread-safe">
<h3>Which resources are Thread-Safe<a class="headerlink" href="#which-resources-are-thread-safe" title="Permalink to this heading">#</a></h3>
<p><img alt="Threadsafe" src="../_images/threadsafe.jpeg" /></p>
</section>
</section>
<section id="multithreading-in-practice">
<h2>Multithreading in Practice<a class="headerlink" href="#multithreading-in-practice" title="Permalink to this heading">#</a></h2>
<section id="running-computation-into-a-separate-thread-spawning-threads">
<h3>Running computation into a separate thread - spawning threads<a class="headerlink" href="#running-computation-into-a-separate-thread-spawning-threads" title="Permalink to this heading">#</a></h3>
<p>Using Thread class:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">MyClass</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using Runnable interface:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w"> </span><span class="nd">@Override</span>
<span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">//…</span>
<span class="w"> </span><span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</section>
<section id="basic-thread-synchronization">
<h3>Basic Thread synchronization<a class="headerlink" href="#basic-thread-synchronization" title="Permalink to this heading">#</a></h3>
<p>Thread might “cache” some shared data and prevent scanning it when other threads modify it.</p>
<blockquote>
<div><p>Use <code class="docutils literal notranslate"><span class="pre">volatile</span></code> keyword in the data field declaration to avoid this.</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">t1.join()</span></code> returns to main thread only when <code class="docutils literal notranslate"><span class="pre">t1</span></code> finishes meaning <code class="docutils literal notranslate"><span class="pre">t1</span></code> <strong>blocks</strong> the main thread.</p>
<p>To fixing thread interleaving (on a modifiable data):</p>
<ul class="simple">
<li><p>Make the modification operation “atomic” by making methods for each operation <em>synchronized</em> using <code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">synchronized</span> <span class="pre">void</span> <span class="pre">fn()</span></code>.</p></li>
<li><p>Java <code class="docutils literal notranslate"><span class="pre">Object</span></code> implements and intrinsic lock (mutex) if we use <code class="docutils literal notranslate"><span class="pre">synchronized</span></code> keyword, a thread can only access the object if the lock is available.</p></li>
</ul>
<p>Problem with synchronized methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">time</span> <span class="pre">taken</span> <span class="pre">=</span> <span class="pre">(no.</span> <span class="pre">of</span> <span class="pre">threads)</span> <span class="pre">*</span> <span class="pre">(unit</span> <span class="pre">work</span> <span class="pre">time)</span></code> =&gt; multithreading advantage is compromised.</p></li>
<li><p>Independent methods still have to be executed sequentially (as the lock on object is no available while some thread accessing some orthogonal/independent method).</p></li>
</ul>
<p><strong>Solution:</strong></p>
<p><strong>synchronized block</strong> with different locks for each independent code block (use n - different objects to act as locks and pass them to synchronized of each block)</p>
<blockquote>
<div><p>Default it is <code class="docutils literal notranslate"><span class="pre">synchronized(this)</span></code>
Bad practice to lock on actual working object (shared data), multiple of them might point to the same (java optimization).
Better to create separate locks.</p>
</div></blockquote>
</section>
<section id="thread-pools">
<h3>Thread Pools<a class="headerlink" href="#thread-pools" title="Permalink to this heading">#</a></h3>
<p>Way of managing lots of threads at the same time.</p>
<blockquote>
<div><p>a collection of fixed number of workers</p>
</div></blockquote>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//no. of workers</span>
<span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="c1">//defining thread pool with fixed size</span>
<span class="n">ExecutorService</span><span class="w"> </span><span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Executors</span><span class="p">.</span><span class="na">newFixedThreadPool</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1">//allotting tasks to the executor service</span>
<span class="n">executor</span><span class="p">.</span><span class="na">submit</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">myCustomThread1</span><span class="p">());</span>
<span class="n">executor</span><span class="p">.</span><span class="na">submit</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">myCustomThread2</span><span class="p">());</span>
<span class="c1">//...</span>

<span class="c1">//stop accepting new tasks and it will shutdown after all are completed.</span>
<span class="n">executor</span><span class="p">.</span><span class="na">shutdown</span><span class="p">();</span>

<span class="c1">//waits only for specified time and then will return</span>
<span class="n">Executor</span><span class="p">.</span><span class="na">awaitTermination</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="n">TimeOut</span><span class="p">.</span><span class="na">MILLIS</span><span class="p">);</span>
</pre></div>
</div>
<p>Implementing thread-pool from scratch</p>
<ul class="simple">
<li><p><a class="reference external" href="http://tutorials.jenkov.com/java-concurrency/thread-pools.html">jenkov</a></p></li>
<li><p><a class="reference external" href="https://www.javacodegeeks.com/2016/12/implement-thread-pool-java.html">javacodegeeeks</a></p></li>
<li><p><a class="reference external" href="https://caffinc.github.io/2016/03/simple-threadpool/">caffinc - simple-threadpool</a></p></li>
</ul>
</section>
<section id="countdownlatch">
<h3>CountDownLatch<a class="headerlink" href="#countdownlatch" title="Permalink to this heading">#</a></h3>
<p>A thread safe class</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//initialize with a count</span>
<span class="n">CountDownLatch</span><span class="w"> </span><span class="n">latch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CountDownLatch</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="c1">//counting it down</span>
<span class="n">latch</span><span class="p">.</span><span class="na">countDown</span><span class="p">();</span>
<span class="c1">//wait till it is 0</span>
<span class="n">latch</span><span class="p">.</span><span class="na">await</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="concurrent-thread-safe-data-structures">
<h3>Concurrent (thread-safe) Data structures<a class="headerlink" href="#concurrent-thread-safe-data-structures" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>All classes in <code class="docutils literal notranslate"><span class="pre">java.util.cocurrent.*</span></code> package are concurrent and thread-safe.</p></li>
<li><p>No need to worry about thread synchronization at all.</p></li>
</ul>
</section>
<section id="blockingqueue">
<h3>BlockingQueue<a class="headerlink" href="#blockingqueue" title="Permalink to this heading">#</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">BlockingQueue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>

<span class="c1">//patiently waits till queue-size &lt; size</span>
<span class="n">queue</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">someInt</span><span class="p">);</span>

<span class="c1">//patiently waits till an item is added (if queue is empty)</span>
<span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">queue</span><span class="p">.</span><span class="na">take</span><span class="p">();</span>
</pre></div>
</div>
<blockquote>
<div><p>Both the above methods makes it easy to implement producer-consumer problem.</p>
</div></blockquote>
</section>
<section id="wait-notify">
<h3>Wait-Notify<a class="headerlink" href="#wait-notify" title="Permalink to this heading">#</a></h3>
<section id="wait">
<h4>Wait<a class="headerlink" href="#wait" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Can only be called inside the synchronized block</p></li>
<li><p>Releases the lock on the object “immediately”, it is synchronized on and waits for notification/resumption.</p></li>
</ul>
</section>
<section id="notify">
<h4>Notify<a class="headerlink" href="#notify" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Can only be called inside the synchronized block.</p></li>
<li><p>Notifies the waiting thread. (does not release the lock until the block is over).</p></li>
</ul>
</section>
<section id="notify-all">
<h4>Notify-All<a class="headerlink" href="#notify-all" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>Notifies the waiting thread. (does not release the lock until the block is over).</p></li>
</ul>
</section>
</section>
<section id="re-entrant-lock">
<h3>Re-Entrant Lock<a class="headerlink" href="#re-entrant-lock" title="Permalink to this heading">#</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//lock interface</span>
<span class="n">Lock</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="p">();</span>
</pre></div>
</div>
<p>Bad way to use:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//works just like synchronized block</span>
<span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>
<span class="c1">//do something -&gt; if this throws and exception lock is never released!</span>
<span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
</pre></div>
</div>
<p>Better way:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//do something</span>
<span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Similar to wait/notify in the synchronized block:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Condition</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">newCondition</span><span class="p">();</span>
<span class="c1">//similar to wait()</span>
<span class="n">condition</span><span class="p">.</span><span class="na">await</span><span class="p">();</span>
<span class="c1">//notify</span>
<span class="n">condition</span><span class="p">.</span><span class="na">signal</span><span class="p">();</span>
<span class="c1">//notifyAll</span>
<span class="n">condition</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span>
</pre></div>
</div>
<blockquote>
<div><p>We have to unlock before we can return to the waiting thread after calling signal()</p>
</div></blockquote>
</section>
<section id="deadlock">
<h3>Deadlock<a class="headerlink" href="#deadlock" title="Permalink to this heading">#</a></h3>
<p>2 threads are waiting on each other to release a lock (free the shared resource) -&gt; application frozen.</p>
<blockquote>
<div><p>Simple way to reproduce: lock the different re-entrant locks in different order in each thread.</p>
</div></blockquote>
<p>Deadlock solutions:</p>
<ul class="simple">
<li><p>Lock your locks in the same order in every thread.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">tryLock()</span></code> of the Lock interface.</p></li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">//it returns immediately the status (if success)</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">gotLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">tryLock</span><span class="p">()</span>
<span class="c1">//we should unlock the locks if partially acquired</span>

<span class="c1">//either we should have all the locks (acquired in order)</span>

<span class="c1">//or none (so that other can acquire them)</span>
</pre></div>
</div>
</section>
<section id="semaphores">
<h3>Semaphores<a class="headerlink" href="#semaphores" title="Permalink to this heading">#</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">Semaphore</span><span class="w"> </span><span class="n">sem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Semaphore</span><span class="p">(</span><span class="n">noOfPermits</span><span class="p">);</span>
<span class="c1">//fair semaphore -&gt; new Semaphore(permits, true);</span>
<span class="c1">//it will provide access to the first waiting thread on releasing.</span>

<span class="c1">//get current no. of available permits</span>
<span class="n">sem</span><span class="p">.</span><span class="na">availablePermits</span><span class="p">();</span>

<span class="c1">//acquire -&gt; decrements permits, waits if the permits == 0</span>
<span class="n">sem</span><span class="p">.</span><span class="na">acquire</span><span class="p">();</span>

<span class="c1">//release -&gt; increments permits.</span>
<span class="n">sem</span><span class="p">.</span><span class="na">release</span><span class="p">();</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Semaphore with one permit = Lock</p></li>
<li><p>Can be used to provide “limited-access” -&gt; connection singleton managing connected users - max up to a limit (say 100).</p></li>
</ul>
</section>
<section id="callable-and-future">
<h3>Callable and Future<a class="headerlink" href="#callable-and-future" title="Permalink to this heading">#</a></h3>
<p>To get return results in a scenario of multiple threads in a thread pool.</p>
<p><strong>Callable</strong> - Similar to Runnable but its thread method returns something (unlike Runnable’s void run() method).</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// anonymous implementation to return integer</span>
<span class="n">executor</span><span class="p">.</span><span class="na">submit</span><span class="p">(</span>
<span class="w">    </span><span class="c1">//anonymous class implementing Callable&lt;T&gt; interface</span>
<span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">call</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//do something and return an int</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p><strong>Future</strong> - Very useful for thread execution info/results</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span>//executor.submit(..) return a Future&lt;T&gt; instance
Future&lt;Integer&gt; future = executor.submit(…);

//get returned value
future.get();
//get() will block until the thread associated with the future has returned/executed.
</pre></div>
</div>
<section id="interrupts">
<h4>Interrupts<a class="headerlink" href="#interrupts" title="Permalink to this heading">#</a></h4>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span><span class="p">.</span><span class="na">interrupt</span><span class="p">()</span>
<span class="c1">//doesn&#39;t stop the thread -&gt; there is a stop() method but it is deprecated.</span>
<span class="c1">//it just sets an interrupted flag and continues with the normal execution.</span>

<span class="c1">//we cause Thread.currentThread() instead of explicitly defining a thread</span>
<span class="n">t1</span><span class="p">.</span><span class="na">isInterrupted</span><span class="p">()</span>

<span class="c1">//catching InterruptedException will catch it if the flag is set.</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./java"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="java-misc.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Java - Misc</p>
      </div>
    </a>
    <a class="right-next"
       href="java-snippets.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Java Snippets</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#java-thread-class-methods">Java <code class="docutils literal notranslate"><span class="pre">Thread</span></code> class methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-currentthread"><code class="docutils literal notranslate"><span class="pre">Thread.currentThread()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#long-getid"><code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">getId()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#int-getpriority-and-void-setpriority"><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">getPriority()</span></code> and <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setPriority()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-state-getstate"><code class="docutils literal notranslate"><span class="pre">Thread.State</span> <span class="pre">getState()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-interrupt"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">interrupt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-join"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">join()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-run"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">run()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-setdaemon-boolean-on"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">setDaemon(boolean</span> <span class="pre">on)</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-sleep-long-millis"><code class="docutils literal notranslate"><span class="pre">Thread.sleep(long</span> <span class="pre">millis)</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#void-start"><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">start()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-yield"><code class="docutils literal notranslate"><span class="pre">Thread.yield()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-lifecycle">Thread Lifecycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-does-a-thread-enter-the-non-runnable-state">How does a thread enter the non-runnable state</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-safey">Thread Safey</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-area">Critical Area</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#race-conditions">Race Conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#which-resources-are-thread-safe">Which resources are Thread-Safe</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multithreading-in-practice">Multithreading in Practice</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-computation-into-a-separate-thread-spawning-threads">Running computation into a separate thread - spawning threads</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-thread-synchronization">Basic Thread synchronization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thread-pools">Thread Pools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#countdownlatch">CountDownLatch</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrent-thread-safe-data-structures">Concurrent (thread-safe) Data structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#blockingqueue">BlockingQueue</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wait-notify">Wait-Notify</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#wait">Wait</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notify">Notify</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#notify-all">Notify-All</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#re-entrant-lock">Re-Entrant Lock</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deadlock">Deadlock</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#semaphores">Semaphores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#callable-and-future">Callable and Future</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupts">Interrupts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lalit Prakash Vatsal
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>